name: Codex README Title Check

on:
  schedule:
    - cron: "0 3 * * *"     # Runs every day at 03:00 UTC
  workflow_dispatch: {}      # Allows manual trigger from GitHub UI

jobs:
  codex-readme-title:
    runs-on: ubuntu-latest
    permissions:
      contents: read

    steps:
      - name: Check out repository
        uses: actions/checkout@v4

      - name: Run Codex on README.md
        id: run_codex
        uses: openai/codex-action@v1
        with:
          openai-api-key: ${{ secrets.OPENAI_API_KEY }}
          prompt: |
            You are Codex running inside a GitHub Actions job for the repository ${{ github.repository }}.

            In the current working directory, there is a README.md file at the repository root.
            Perform these steps:

            1. Open the file README.md from the repo root.
            2. Find the main H1 title (the line starting with "# ").
            3. Extract its exact text.
            4. Determine whether ALL letters in that title are uppercase Aâ€“Z
               (ignore spaces, punctuation, and digits).
            5. Respond EXACTLY in this format, with no extra text:

            Title: <title text>
            All Caps: <YES or NO>

      - name: Print Codex result
        run: |
          echo "Codex result:"
          echo "${{ steps.run_codex.outputs.final-message }}"
